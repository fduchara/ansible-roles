<authorizers>

    <userGroupProvider>
        <identifier>file-user-group-provider</identifier>
        <class>org.apache.nifi.authorization.FileUserGroupProvider</class>
        <property name="Users File">/opt/nifi/conf/users.xml</property>
        <property name="Legacy Authorized Users File"/>
        <property name="Initial User Identity 0">nifi_admin</property>

        <property name="Initial User Identity 1">CN=*.local, OU=NIFI</property>
    </userGroupProvider>

    <userGroupProvider>
        <identifier>ldap-user-group-provider</identifier>
        <class>org.apache.nifi.ldap.tenants.LdapUserGroupProvider</class>
        <property name="Authentication Strategy">SIMPLE</property>

        <property name="Manager DN">uid=admin,cn=users,cn=accounts,dc=ans,dc=test,dc=iac,dc=mchs,dc=ru</property>
        <property name="Manager Password">Secret123</property>

        <property name="Referral Strategy">FOLLOW</property>
        <property name="Connect Timeout">10 secs</property>
        <property name="Read Timeout">10 secs</property>
        <property name="Initial Admin Identity">uid=admin,cn=users,cn=accounts,dc=ans,dc=test,dc=iac,dc=mchs,dc=ru</property>

        <property name="Url">ldap://ans.test.iac.mchs.ru:389</property>
        <property name="Sync Interval">30 mins</property>
        <property name="User Search Base">cn=users,cn=accounts,dc=ans,dc=test,dc=iac,dc=mchs,dc=ru</property>
        <property name="User Object Class">person</property>
        <property name="User Search Scope">ONE_LEVEL</property>
        <property name="User Search Filter">
            (memberOf=cn=nifi,cn=groups,cn=accounts,dc=ans,dc=test,dc=iac,dc=mchs,dc=ru)
        </property>
        <property name="User Identity Attribute">uid</property>

        <property name="Group Search Base">cn=groups,cn=accounts,dc=ans,dc=test,dc=iac,dc=mchs,dc=ru</property>
        <property name="Group Object Class">groupOfNames</property>
        <property name="Group Search Scope">ONE_LEVEL</property>
        <property name="Group Search Filter">(cn=nifi)</property>
        <property name="Group Name Attribute">cn</property>
        <property name="Group Member Attribute">member</property>
        <property name="Group Member Attribute - Referenced User Attribute"/>
    </userGroupProvider>

    <userGroupProvider>
        <identifier>composite-configurable-user-group-provider</identifier>
        <class>org.apache.nifi.authorization.CompositeConfigurableUserGroupProvider</class>
        <property name="Configurable User Group Provider">file-user-group-provider</property>
        <property name="User Group Provider 1">ldap-user-group-provider</property>
    </userGroupProvider>

    <accessPolicyProvider>
        <identifier>file-access-policy-provider</identifier>
        <class>org.apache.nifi.authorization.FileAccessPolicyProvider</class>
        <property name="User Group Provider">composite-configurable-user-group-provider</property>
        <property name="Authorizations File">/opt/nifi/conf/authorizations.xml</property>
        <property name="Initial Admin Identity">nifi_admin, CN=*.local, OU=NIFI></property>
        <property name="Legacy Authorized Users File"/>

        <property name="Node Identity 1">CN=*.local, OU=NIFI</property>
    </accessPolicyProvider>

    <authorizer>
        <identifier>managed-authorizer</identifier>
        <class>org.apache.nifi.authorization.StandardManagedAuthorizer</class>
        <property name="Access Policy Provider">file-access-policy-provider</property>
    </authorizer>

</authorizers>
